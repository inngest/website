export const description = 'Learn how to set up Clerk webhooks with Inngest and use Clerk events within Inngest functions.'

# Handling Clerk webhook events

Third party auth providers like [Clerk](https://clerk.com/) are a fantastic way to add auth, user management, and security features to your application. They also provide drop-in components that can get your auth set up quickly. However, with an external source of truth for auth, you'll often need to:

* Sync data from Clerk with your database,
* Provision resources for new accounts, or
* Trigger other work from events (emails, etc).

In this guide, we'll walk through how to set up a Clerk webhook with Inngest and use Clerk events within Inngest functions.

{/* TODO - Some sort of graphic with the Clerk logo and events listed */}

## Setting up the Clerk webhook

Clerk provides a [webhooks](https://clerk.com/docs/integrations/webhooks) feature that allows you to send events to a webhook endpoint when certain events occur. Inngest's [webhook endpoints](/docs/platform/webhooks) allow you to receive these these events within your account just like [events that you send](/docs/events) from your own application.

To set up the Clerk webhook, open the Clerk dashboard and navigate to the Webhooks page. Next, select the Add Endpoint button.

![image](/assets/docs/guides/clerk-webhook-events/webhook-page.webp)

TODO....

---


Often, one key part of integrating with an auth provider like [Clerk](https://clerk.com/) is handling asynchronous updates with a webhook.

```ts
const syncUser = inngest.createFunction(
  { id: 'sync-user-from-clerk' },
  { event: 'clerk/user.created' },
  async ({ event }) => {
    const { user } = event.data
    const { id, first_name, last_name } = user
    const email = user.email_addresses.find(e =>
      e.id === user.primary_email_address_id
    ).email
    await database.users.insert({ id, email, first_name, last_name })
  }
)
```

```ts
const sendWelcomeEmail = inngest.createFunction(
  { id: 'send-welcome-email' },
  { event: 'clerk/user.created' },
  async ({ event }) => {
    const { user } = event.data
    const { first_name } = user
    const email = user.email_addresses.find(e =>
      e.id === user.primary_email_address_id
    ).email
    await emails.sendWelcomeEmail({ email, first_name })
  }
)
```

```ts
const sendWelcomeEmail = inngest.createFunction(
  { id: 'send-welcome-email' },
  { event: 'clerk/user.created' },
  async ({ event, step }) => {
    const { user } = event.data
    const { first_name } = user
    const email = user.email_addresses.find(e =>
      e.id === user.primary_email_address_id
    ).email

    await step.run('welcome-email', async () => {
      await emails.sendWelcomeEmail({ email, first_name })
    })

    // wait 3 days before second email
    await step.sleep('wait-3-days', '3 days')

    await step.run('trial-offer-email', async () => {
      await emails.sendTrialOfferEmail({ email, first_name })
    })
  }
)
```